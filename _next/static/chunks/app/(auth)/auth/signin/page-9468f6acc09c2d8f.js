(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8],{2965:(e,t,n)=>{Promise.resolve().then(n.bind(n,15722))},15722:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>G});var a=n(95155),i=n(12115),s=n(35695),r=n(49694),l=n(83043),o=n(63416),c=n(700),u=n(12279),d=n(97123),m=n(74335),h=n(7068),g=n(20261),p=n(74964),f=n(28428),x=n(76770),b=n.n(x),w=n(53440),S=n(6874),v=n.n(S),j=n(73418),A=n(20714),k=n(29942);let R={email:"",userRole:o.gG1.Reader},C=l.Ik().shape({email:l.Yj().email("Please enter a valid email address").required("Email is required")}),I=e=>{if(!e)return null;switch(e.response.errors[0].message){case"USER_NOT_FOUND":return{field:"login",message:"We couldn't find that one. Want to try another?"};case"INVALID_PASSWORD":return{field:"password",message:"The password you entered is incorrect. Try again."};case"EMAIL_IS_INVALID":return{field:"login",message:"Please enter a valid email address"};default:return{field:null,message:"Internal Server Error"}}};function y(){let e=(0,s.useSearchParams)().get("ref"),t=(0,A.A)().mutateAsync,n=(0,k.k)(),{startGoogleLogin:l,loading:x}=(0,j.A)({userRole:o.gG1.Reader,afterLogin:e=>{n(e.loginWithGoogle)}}),[S,y]=(0,i.useState)(null),E=(0,r.Wx)({initialValues:R,validationSchema:C,onSubmit:e=>t({input:{email:e.email,userRole:o.gG1.Reader}}).then(()=>{let t=new URLSearchParams(window.location.search);t.set("checkEmail",encodeURIComponent(e.email)),b().start(),window.history.pushState({},"","?".concat(t.toString()))}).catch(e=>y(I(e)))});return(0,a.jsx)(h.A,{direction:"column",justifyContent:{xs:"center",sm:"flex-start"},alignItems:"center",height:"100%",gap:2,children:(0,a.jsxs)(h.A,{width:"100%",maxWidth:{sm:"400px"},mx:"auto",mt:{xs:"auto",sm:"0px"},direction:"column",alignItems:"center",children:[(0,a.jsx)(g.A,{sx:{fontSize:"80px"}}),(0,a.jsx)(c.A,{variant:"h3",fontWeight:"bold",my:"24px",children:"Log in or sign up"}),(0,a.jsxs)(h.A,{component:"form",onSubmit:E.handleSubmit,width:"100%",children:[(0,a.jsx)(f.A,{label:"Continue with Google",loading:x,onClick:()=>l(),fullWidth:!0}),(0,a.jsx)(p.A,{sx:{my:"16px"},className:"color-medium",children:(0,a.jsx)(c.A,{variant:"body2",color:"secondary.low",fontWeight:"medium",textAlign:"center",children:"or"})}),(0,a.jsxs)(h.A,{width:"100%",direction:"column",alignItems:"stretch",gap:"16px",children:[(0,a.jsx)(d.A,{fullWidth:!0,variant:"outlined",name:"email",placeholder:"Email",value:E.values.email,onChange:E.handleChange,error:!!E.errors.email&&!!E.touched.email||(null==S?void 0:S.field)==="email",helperText:(null==S?void 0:S.field)==="email"&&(null==S?void 0:S.message)||E.touched.email&&E.errors.email}),(0,a.jsx)(u.A,{disabled:E.isSubmitting,fullWidth:!0,variant:"contained",size:"large",onClick:()=>E.handleSubmit(),children:(0,a.jsx)(m.A,{loading:E.isSubmitting,label:"Continue with code"})})]})]}),(0,a.jsx)(w.A,{mt:"24px",variant:"caption",fontWeight:"medium",component:v(),href:"/auth/invite".concat(e?"?ref=".concat(e):""),children:"Create on Tapflow"})]})})}var E=n(83747),P=n(50638),W=n(63909);function D(e){let{email:t}=e,n=(0,W.A)(),i=(0,s.useParams)().pageId,r=(0,A.A)().mutateAsync,l=(0,P.A)(),c=l.mutateAsync,u=(0,k.k)();return(0,a.jsx)(E.A,{email:t,sendVerificationCode:()=>r({input:{email:t,userRole:o.gG1.Reader,loginContext:{pageId:i,productId:n}}}),verifyCode:(e,n)=>c({input:{email:t,signInCode:n}}).then(e=>{u(e.verifyEmailCode)}),isLoading:l.isPending})}let _=(0,n(65453).v)(e=>({authDisabled:!1,setAuthDisabled:t=>e({authDisabled:t}),guestDisabled:!1,setGuestDisabled:t=>e({guestDisabled:t})}));function L(){let e=(0,s.useSearchParams)().get("checkEmail");return e?(0,a.jsx)(i.Suspense,{fallback:null,children:(0,a.jsx)(D,{email:decodeURIComponent(e)})}):(0,a.jsx)(i.Suspense,{fallback:null,children:(0,a.jsx)(y,{})})}function U(){return(0,i.useEffect)(()=>(_.getState().setGuestDisabled(!0),()=>{_.getState().setGuestDisabled(!1)}),[]),(0,a.jsx)(i.Suspense,{fallback:null,children:(0,a.jsx)(L,{})})}function G(){return(0,a.jsx)(U,{})}},29942:(e,t,n)=>{"use strict";n.d(t,{k:()=>c});var a=n(65054),i=n(63416),s=n(35695),r=n(76770),l=n.n(r),o=n(967);let c=()=>{let e=(0,s.useRouter)(),t=(0,s.useSearchParams)();return n=>{(0,o.YW)(n).with({user:{status:i._OY.Pending,isWaitListFormSubmitted:!1}},e=>{let{user:t}=e;console.log("1 user in waitlist, form not submitted",t),l().start(),window.location.href="".concat("https://apply.tapflow.co","?email=").concat(encodeURIComponent(t.email))}).with({user:{onboarding:{hasIntroSeen:!1}}},()=>{console.log("2 user in active"),l().start();let t=new URLSearchParams(window.location.search);t.set("step",a.j[a.j.intro]),t.delete("checkEmail");let n="/onboarding?".concat(t.toString());e.push(n)}).with({user:{onboarding:{isDisplayNameSet:!1}}},()=>{l().start();let t=new URLSearchParams(window.location.search);t.set("step",a.j[a.j.name]),t.delete("checkEmail");let n="/onboarding?".concat(t.toString());e.push(n)}).with({user:{onboarding:{isUsernameSet:!1}}},()=>{console.log("4 user in active but onboarding not completed"),l().start();let t=new URLSearchParams(window.location.search);t.set("step",a.j[a.j.username]),t.delete("checkEmail");let n="/onboarding?".concat(t.toString());e.push(n)}).otherwise(()=>{console.log("4 user in active and onboarding completed"),l().start();let n=t.get("returnTo");e.push(n||"/home")})}}},63909:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var a=n(35695);function i(){var e;return null==(e=(0,a.useParams)().productId)?void 0:e.split("-").slice(-1)[0]}},65054:(e,t,n)=>{"use strict";n.d(t,{j:()=>a});var a=function(e){return e[e.intro=0]="intro",e[e.name=1]="name",e[e.avatar=2]="avatar",e[e.username=3]="username",e[e.plan=4]="plan",e}({})}},e=>{var t=t=>e(e.s=t);e.O(0,[4123,1763,5986,2443,180,8341,2279,6478,1182,251,4228,3313,7123,7244,8991,4134,9822,9694,3043,5445,4136,5100,4837,8441,820,7358],()=>t(2965)),_N_E=e.O()}]);
//# sourceMappingURL=page-9468f6acc09c2d8f.js.map