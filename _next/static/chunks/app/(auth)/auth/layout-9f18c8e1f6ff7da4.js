(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8238],{29942:(e,t,n)=>{"use strict";n.d(t,{k:()=>c});var r=n(65054),a=n(63416),o=n(35695),s=n(76770),i=n.n(s),l=n(967);let c=()=>{let e=(0,o.useRouter)(),t=(0,o.useSearchParams)();return n=>{(0,l.YW)(n).with({user:{status:a._OY.Pending,isWaitListFormSubmitted:!1}},e=>{let{user:t}=e;console.log("1 user in waitlist, form not submitted",t),i().start(),window.location.href="".concat("https://apply.tapflow.co","?email=").concat(encodeURIComponent(t.email))}).with({user:{onboarding:{hasIntroSeen:!1}}},()=>{console.log("2 user in active"),i().start();let t=new URLSearchParams(window.location.search);t.set("step",r.j[r.j.intro]),t.delete("checkEmail");let n="/onboarding?".concat(t.toString());e.push(n)}).with({user:{onboarding:{isDisplayNameSet:!1}}},()=>{i().start();let t=new URLSearchParams(window.location.search);t.set("step",r.j[r.j.name]),t.delete("checkEmail");let n="/onboarding?".concat(t.toString());e.push(n)}).with({user:{onboarding:{isUsernameSet:!1}}},()=>{console.log("4 user in active but onboarding not completed"),i().start();let t=new URLSearchParams(window.location.search);t.set("step",r.j[r.j.username]),t.delete("checkEmail");let n="/onboarding?".concat(t.toString());e.push(n)}).otherwise(()=>{console.log("4 user in active and onboarding completed"),i().start();let n=t.get("returnTo");e.push(n||"/home")})}}},59189:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(95155),a=n(12115),o=n(53267),s=n(14426);function i(e){let{color:t="primary",name:n}=e;return(0,a.useEffect)(()=>{n&&console.log("Loading ".concat(n,"..."))},[n]),(0,r.jsx)(o.A,{position:"fixed",top:0,left:0,width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",children:(0,r.jsx)(s.A,{disableShrink:!0,color:t})})}},65054:(e,t,n)=>{"use strict";n.d(t,{j:()=>r});var r=function(e){return e[e.intro=0]="intro",e[e.name=1]="name",e[e.avatar=2]="avatar",e[e.username=3]="username",e[e.plan=4]="plan",e}({})},96143:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>w});var r=n(95155),a=n(12115),o=n(35695),s=n(76770),i=n.n(s),l=n(59189),c=n(55100),u=n(63416),d=n(25731),h=n(29942);let p=e=>{let{onMount:t,onUnmount:n}=e;return(0,a.useEffect)(()=>(t(),()=>n()),[t,n]),null};function m(e){var t;let n=(0,o.useRouter)(),s=(0,o.usePathname)(),m=(0,o.useSearchParams)(),{authenticated:g,refetch:f}=(0,c.Ay)(),w=(0,h.k)(),{mutateAsync:x,isPending:v}=(t={onSuccess:()=>f().then(e=>{var t;return w(null==e||null==(t=e.data)?void 0:t.ping)}),onError:()=>f().then(e=>{var t;return w(null==e||null==(t=e.data)?void 0:t.ping)})},(0,u.cg)(d.z,t,void 0)),b=a.useRef(!1),j=b.current,[S,k]=(0,a.useState)(!0),E=m.get("checkEmail"),y=m.has("ref"),P=null==s?void 0:s.startsWith("/auth"),R=g&&y&&P;return((0,a.useEffect)(()=>{if(!v){if(R)return void x({inviteCode:m.get("ref")||""});if(!b.current){if(g&&!E){let e=m.get("returnTo")||"/home";i().start(),console.log("GuestGuard","Redirecting to",e),n.replace(e);return}k(!1)}}},[g,E,n,m,x,y,v,R]),S&&!j)?(0,r.jsx)(l.A,{color:P?"secondary":"primary"}):(0,r.jsxs)(r.Fragment,{children:[e.children,(0,r.jsx)(p,{onMount:()=>{b.current=!0},onUnmount:()=>{b.current=!1}})]})}function g(e){return(0,r.jsx)(a.Suspense,{fallback:null,children:(0,r.jsx)(m,{...e})})}var f=n(18407);function w(e){return(0,r.jsx)(g,{children:(0,r.jsx)(f.A,{sx:{width:["100%","360px"],alignSelf:["flex-end","center"],borderRadius:["16px 16px 0px 0px","16px"],px:"24px",py:"28px"},children:e.children})})}},99607:(e,t,n)=>{Promise.resolve().then(n.bind(n,96143))}},e=>{var t=t=>e(e.s=t);e.O(0,[5986,2443,180,1025,5100,8441,820,7358],()=>t(99607)),_N_E=e.O()}]);
//# sourceMappingURL=layout-9f18c8e1f6ff7da4.js.map