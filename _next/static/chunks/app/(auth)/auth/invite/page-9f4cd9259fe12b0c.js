(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6087],{20568:(e,t,n)=>{Promise.resolve().then(n.bind(n,56185))},29942:(e,t,n)=>{"use strict";n.d(t,{k:()=>d});var i=n(65054),a=n(63416),r=n(35695),l=n(76770),o=n.n(l),s=n(967);let d=()=>{let e=(0,r.useRouter)(),t=(0,r.useSearchParams)();return n=>{(0,s.YW)(n).with({user:{status:a._OY.Pending,isWaitListFormSubmitted:!1}},e=>{let{user:t}=e;console.log("1 user in waitlist, form not submitted",t),o().start(),window.location.href="".concat("https://apply.tapflow.co","?email=").concat(encodeURIComponent(t.email))}).with({user:{onboarding:{hasIntroSeen:!1}}},()=>{console.log("2 user in active"),o().start();let t=new URLSearchParams(window.location.search);t.set("step",i.j[i.j.intro]),t.delete("checkEmail");let n="/onboarding?".concat(t.toString());e.push(n)}).with({user:{onboarding:{isDisplayNameSet:!1}}},()=>{o().start();let t=new URLSearchParams(window.location.search);t.set("step",i.j[i.j.name]),t.delete("checkEmail");let n="/onboarding?".concat(t.toString());e.push(n)}).with({user:{onboarding:{isUsernameSet:!1}}},()=>{console.log("4 user in active but onboarding not completed"),o().start();let t=new URLSearchParams(window.location.search);t.set("step",i.j[i.j.username]),t.delete("checkEmail");let n="/onboarding?".concat(t.toString());e.push(n)}).otherwise(()=>{console.log("4 user in active and onboarding completed"),o().start();let n=t.get("returnTo");e.push(n||"/home")})}}},56185:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>U});var i=n(95155),a=n(12115),r=n(83043),l=n(49694),o=n(6874),s=n.n(o),d=n(63416),c=n(700),u=n(12279),m=n(97123),h=n(35695),g=n(74335),p=n(7068),f=n(20261),x=n(28428),v=n(74964),w=n(76770),b=n.n(w),A=n(53440),j=n(73418),S=n(20714),I=n(25731),y=n(967),E=n(29942);let C=r.Ik().shape({email:r.Yj().email("Please enter a valid email address").required("Email is required")}),k=e=>{if(!e)return null;switch(e.response.errors[0].message){case"EMAIL_IS_BUSY":return{field:"email",message:"Email is already registered"};case"PARTNER_NOT_FOUND":return{field:null,message:"Partner that invited you is not found"};case"PARTNER_INVITE_NOT_FOUND":return{field:null,message:"Invite for partner is not found"};case"INVALID_INVITE_CODE":return{field:null,message:"Link expired, email us for a new one"};default:return{field:null,message:"Internal Server Error"}}},N=()=>{var e,t;let n=(0,h.useSearchParams)(),a=n.get("ref"),r=n.get("email"),o=(e={code:a||""},t={enabled:!!a},(0,d.hxU)(I.z,e,t,void 0)),w=(0,E.k)(),{startGoogleLogin:N,loading:_}=(0,j.A)({inviteCode:a,userRole:d.gG1.Author,afterLogin:e=>{w(null==e?void 0:e.loginWithGoogle)}}),P=(0,S.A)().mutateAsync,R=(0,l.Wx)({initialValues:{email:r||"",userRole:d.gG1.Author},validationSchema:C,onSubmit:(e,t)=>P({input:{email:e.email,userRole:d.gG1.Author,inviteCode:a}}).then(()=>{let t=new URLSearchParams(window.location.search);t.set("checkEmail",encodeURIComponent(e.email)),t.delete("ref"),t.delete("email"),b().start(),window.history.pushState({},"","?".concat(t.toString()))}).catch(e=>{let n=k(e);(null==n?void 0:n.field)&&t.setFieldError(n.field,n.message)})});return(0,i.jsx)(p.A,{direction:"column",justifyContent:{xs:"center",sm:"flex-start"},alignItems:"center",height:"100%",gap:2,children:(0,i.jsxs)(p.A,{width:"100%",maxWidth:{sm:"400px"},mx:"auto",mt:{xs:"auto",sm:"0px"},direction:"column",alignItems:"center",children:[(0,i.jsx)(f.A,{sx:{fontSize:"80px"}}),(0,i.jsxs)(p.A,{gap:"6px",my:"24px",alignItems:"center",children:[(0,i.jsx)(c.A,{variant:"h3",fontWeight:"bold",children:"Start creating on Tapflow"}),(0,y.YW)(o).with({data:{getInviteByCode:y.P.nonNullable}},()=>{var e,t,n,a,r,l;return(0,i.jsxs)(p.A,{direction:"row",alignItems:"center",gap:"3px",children:[(0,i.jsx)(c.A,{variant:"body2",fontWeight:"medium",color:"text.surface.medium",children:"Youâ€™re invited by"}),(0,i.jsx)(A.A,{variant:"body2",fontWeight:"medium",component:s(),href:"/".concat(null==o||null==(n=o.data)||null==(t=n.getInviteByCode)||null==(e=t.owner)?void 0:e.username),children:null==o||null==(l=o.data)||null==(r=l.getInviteByCode)||null==(a=r.owner)?void 0:a.name})]})}).with({error:{response:{errors:[{message:"INVALID_INVITE_CODE"}]}}},()=>(0,i.jsx)(c.A,{variant:"body2",fontWeight:"medium",color:"text.surface.medium",children:"Your invite code is invalid"})).with({isFetching:!0},()=>(0,i.jsx)(c.A,{variant:"body2",fontWeight:"medium",color:"text.surface.medium",children:"Loading..."})).otherwise(()=>null)]}),(0,i.jsxs)(p.A,{component:"form",onSubmit:R.handleSubmit,width:"100%",children:[(0,i.jsx)(x.A,{label:"Continue with Google",loading:_,onClick:()=>N(),fullWidth:!0,disabled:o.isFetching}),(0,i.jsx)(v.A,{sx:{my:"16px"},className:"color-medium",children:(0,i.jsx)(c.A,{variant:"body2",color:"secondary.low",fontWeight:"medium",textAlign:"center",children:"or"})}),(0,i.jsxs)(p.A,{width:"100%",direction:"column",alignItems:"stretch",gap:"16px",children:[(0,i.jsx)(m.A,{fullWidth:!0,variant:"outlined",name:"email",type:"email",placeholder:"Email",disabled:o.isFetching,value:R.values.email,onChange:R.handleChange,error:!!R.errors.email&&!!R.touched.email,helperText:R.touched.email&&R.errors.email}),(0,i.jsx)(u.A,{disabled:R.isSubmitting||o.isFetching,fullWidth:!0,variant:"contained",size:"large",onClick:()=>R.handleSubmit(),children:(0,i.jsx)(g.A,{loading:R.isSubmitting,label:"Continue"})})]})]}),(0,i.jsx)(A.A,{mt:"24px",variant:"caption",fontWeight:"medium",component:s(),href:"/auth/signin",children:"Not a creator? Join as a member"})]})})};var _=n(83747),P=n(50638);function R(e){let{email:t}=e,n=(0,h.useSearchParams)(),a=(0,S.A)().mutateAsync,r=(0,P.A)(),l=r.mutateAsync,o=(0,E.k)();return(0,i.jsx)(_.A,{email:t,sendVerificationCode:()=>a({input:{email:t,userRole:d.gG1.Author,inviteCode:n.get("ref")}}),verifyCode:(e,n)=>l({input:{email:t,signInCode:n}},{onSuccess:e=>{let{verifyEmailCode:t}=e;o(t)}}),isLoading:r.isPending})}function W(){let e=(0,h.useSearchParams)().get("checkEmail");return e?(0,i.jsx)(a.Suspense,{fallback:null,children:(0,i.jsx)(R,{email:decodeURIComponent(e)})}):(0,i.jsx)(a.Suspense,{fallback:null,children:(0,i.jsx)(N,{})})}function L(){return(0,i.jsx)(a.Suspense,{fallback:null,children:(0,i.jsx)(W,{})})}function U(){return(0,i.jsx)(L,{})}},65054:(e,t,n)=>{"use strict";n.d(t,{j:()=>i});var i=function(e){return e[e.intro=0]="intro",e[e.name=1]="name",e[e.avatar=2]="avatar",e[e.username=3]="username",e[e.plan=4]="plan",e}({})}},e=>{var t=t=>e(e.s=t);e.O(0,[4123,1763,5986,2443,180,8341,2279,6478,1182,251,4228,3313,7123,7244,8991,4134,9822,9694,3043,5445,9275,5100,4837,8441,820,7358],()=>t(20568)),_N_E=e.O()}]);
//# sourceMappingURL=page-9f4cd9259fe12b0c.js.map